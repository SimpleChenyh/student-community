<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.manage.mapper.ActivityMapper">
    <resultMap type="com.manage.entity.Activity" id="Activity">
        <id property="activityid" column="activity_id"/>
        <result column="community_id" property="communityid" jdbcType="TIMESTAMP" />
        <result column="activity_title" property="activityTitle" jdbcType="VARCHAR" />
        <result column="activity_loc" property="activityLoc" jdbcType="VARCHAR" />
        <result column="activity_content" property="activityContent"/>
        <result column="activity_date" property="activityDate" jdbcType="TIMESTAMP" />
        <result column="closing_date" property="closeingDate" jdbcType="TIMESTAMP" />
        <result column="start_date" property="startDate" jdbcType="TIMESTAMP" />
        <result column="end_date" property="endDate" jdbcType="TIMESTAMP" />
        <result column="status" property="status" jdbcType="INTEGER" />
    </resultMap>
    <sql id="sqlColumn">
        activity_id,activity.community_id,activity_title,activity_loc,activity_content,activity_date,closing_date,start_date,end_date,status
    </sql>
    <!-- 输出参数 -->
    <!-- 分页式，模糊查询 -->
    <!-- parameter传入参数 -->
    <!-- result传出参数 -->
    <select id="getAllActivity" parameterType="map"  resultMap="Activity">
        select 
        <include refid="sqlColumn"></include>
        from activity  
        <where>
        <if test="communityid != null ">
         and  community_id = #{communityid} 
        </if>
        <if test="activityTitle != null and activityTitle != '' ">  
        and activity_title = #{activityTitle}
        </if>
        <if test="activityContent !=null and activityContent !=''">
        <!-- 模糊查询 -->
         and activity_content like '%${activityContent}%'
        </if>

        </where>
        order by activity_id desc
        limit #{startIndex},#{rows}
    </select>
    <!-- 总条数 -->
    <select id="getAllCount" resultType="Integer">
        select 
        <include refid="sqlColumn"></include>
        from activity  
        <where>
        <if test="communityid !=null ">
         and  community_id = #{communityid} 
        </if>
        <if test="activityTitle !=null and activityTitle != '' ">  
        and activity_title =#{activityTitle}
        </if>
        <if test="activityContent !=null and activityContent !=''">
        <!-- 模糊查询 -->
         and activity_content like '%${activityContent}%'
        </if>
        </where>
         order by activity_id desc
        limit #{startIndex},#{rows}
    </select>
    <!-- 输入参数 -->
    <insert id="addActivity" parameterType="com.manage.mapper.ActivityMapper">
            insert into activity(community_id,activity_title,activity_loc,activity_content,activity_date,closing_date,start_date,end_date)
            VALUES(#{communityId,jdbcType=INTEGER},,#{activityTitle},#{activityLoc},#{activityContent},#{activityDate},#{closeingDate},#{startDate},#{endDate},0) 
    </insert>
</mapper>